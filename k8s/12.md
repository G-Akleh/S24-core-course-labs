# Kubernetes ConfigMaps

## Upgrade Application for Persistence

The app.py is updated to include visits counter. More info in the README.md.

The updated visits are recorded at `../app_python/visits/visits.txt`

## ConfigMap Implementation

*Note: I created a new helm chart: `helm create python-chart`*

Output of the command `helm install python-app python-chart/ --values python-chart/values.yaml`:

```bash
NAME: python-app
LAST DEPLOYED: Wed Apr 24 03:40:33 2024
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
     NOTE: It may take a few minutes for the LoadBalancer IP to be available.
           You can watch the status of by running 'kubectl get --namespace default svc -w python-app'
  export SERVICE_IP=$(kubectl get svc --namespace default python-app --template "{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}")
  echo http://$SERVICE_IP:5000
```
---
The output of the command `kubectl describe configmap ghadeer-app-configmap`:

```bash
Name:         ghadeer-app-configmap
Namespace:    default
Labels:       app.kubernetes.io/managed-by=Helm
Annotations:  meta.helm.sh/release-name: python-app
              meta.helm.sh/release-namespace: default

Data
====
config.json:
----
{
    "name": "Ghadeer",
    "fruit": "Watermelon"
  }
key:
----
value

BinaryData
====

Events:  <none>
```
---

output of the command: `kubectl get po`:

```bash
NAME                          READY   STATUS      RESTARTS   AGE
post-install-hook             0/1     Completed   0          52s
pre-install-hook              0/1     Completed   0          59s
python-app-6c49497c66-hgsmx   1/1     Running     0          52s
```
---

The output of the command `kubectl exec python-app-6c49497c66-hgsmx -- cat /config.json`:

```bash
{
    "name": "Ghadeer",
    "fruit": "Watermelon"
  }
```